#include "LedManager.h"
#include <string>

#define DEBUG

LedManager ledMgr;

const char* jsonData = "{\
   \"picture\": {\
      \"fan_1\": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\
      \"fan_2\": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\
      \"fan_3\": [16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080, 16750080],\
      \"bl_fan\": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\
   },\
   \"timeline\": [\
      {\
         \"Start\": 0,\
         \"name\": \"fan_1\",\
         \"alpha\": 1\
      },\
      {\
         \"Start\": 1000,\
         \"name\": \"fan_2\",\
         \"alpha\": 0.5\
      },\
      {\
         \"Start\": 2000,\
         \"name\": \"bl_fan\",\
         \"alpha\": 1\
      }\
   ]\
}";

void setup() {
   Serial.begin(115200);
   pinMode(13, INPUT);   // Initialize the LED_BUILTIN pin as an output
   delay(10);

   ledMgr.init();
   if(!ledMgr.parsing_json(jsonData))
      ESP.restart();

   delay(1000);
   Serial.println("setup");
   ledMgr.play(500);
}

void loop() {
   ledMgr.loop();
}